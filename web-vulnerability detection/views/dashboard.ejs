<%- include("partials/header2")-%>


<div class="container">


  <!-- modal for checking t and C -->

  
  
  <!-- Modal -->
  <div class="modal fade" id="tmodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Confirm Submission</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h6><input type="checkbox" id="ch1" required> By checking this box you agree that you have permission to scan the target</h6>
        </div>
        <div class="modal-footer">
          <p id="loader_text" style="color: #243d81; font-size: 1.5rem;font-weight:bolder;">SCANNING....</p>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="agree">Submit</button>
        </div>
      </div>
    </div>
  </div>




  <!-- modal for displaying result -->
  <div class="modal fade" id="MyModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title heading" id="exampleModalLongTitle">Quick Scan</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h4><%= web %></h4>
          <br>
          <% if(quickscan != ""){%>
          <h6 class="heading">IP Address: <%=quickscan[0].ip %> </h6>
          <%}%>
              <br>
              <% if(ssl != "" && ssl.valid == true){%>
          <h6 class="heading">SSL:</h6>
          <h6 class="subheading">SSL Certificate: Present </h6>
          <h6 class="subheading">Number of days left :<%= ssl.daysRemaining%></h6>

          <%}else{%>
          <h6 class="subheading">SSL Certificate: Not Present </h6>
          <%}%>
              <br>
              <% if(missing_headers != "" ){%>
          <h6 class="heading">Missing Headers:</h6>
          <% var m = missing_headers%>
          <table>
            <%m.forEach(myFunction);%>

            <%function myFunction(item, index) {%>

            <% if(index < 10){%>
            <%var s = (item.msg).split(":");%>

            <tr>
              <td class="subheading"> <%=s[0]%></td>
              <td class="subheading"><%=s[1]%></td>
            </tr>
            <% }%>
            <%}%>

                </table>
            <%}%>
        </div>
        <div class="modal-footer">
          <form method="POST" action="/download" id="form3">
            <input type="submit" value="download Report" class="btn btn-primary">
          </form>
        </div>
      </div>
    </div>
  </div>



  <!-- modal for full scan -->


  <div class="modal fade" id="MyModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title heading" id="exampleModalLongTitle">Full Scan</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h4><%= web %></h4>
          <br>

          <% if(fullscan) {%>

          <h6 class="heading">IP Address: <%=fullscan[0].ip %> </h6>
          <br>
          <h6 class="heading">OS: <%=fullscan[0].osNmap %> </h6>

          <br>

          <h6 class="heading">OPEN PORTS:</h6>

          <% var o =fullscan[0].openPorts %>
          <table>
            <tr>
              <th class="subheading">PORTS</th>
              <th class="subheading">SERVICE</th>
            </tr>
            <%o.forEach(myFunction);%>

            <%function myFunction(item, index) {%>

            <% if(index < 10){%>
            <tr>
              <td class="subheading"> <%=item.port%></td>
              <td class="subheading"> <%=item.service%></td>
            </tr>

            <% }%>
            <%}%>
    
                </table>
              
              <br>
                <h6 class="heading">TECHNOLOGIES DETECTED:</h6>
          <% } %>
            <% if(tech != ""){%>
            <% var t =tech%>
            <table>
              <tr>
                <th class="subheading">TECHNOLOGY</th>
                <th class="subheading">VERSION</th>
              </tr>
              <%t.forEach(myFunction);%>

              <%function myFunction(item, index) {%>

              <% if(index < 10){%>
              <tr>
                <td class="subheading"> <%=item.name%> : </td>
                <td class="subheading"> <%=item.version%> </td>
              </tr>

              <% }%>
              <%}%>

                </table>

                <%}%>

              <% if(ssl != "" && ssl.valid == true){%>
              <h6 class="heading">SSL:</h6>
              <h6 class="subheading">SSL Certificate: Present </h6>
              <h6 class="subheading">Number of days left :<%= ssl.daysRemaining%></h6>
              <h6 class="subheading">Valid from :<%= ssl.validFrom%></h6>
              <h6 class="subheading">Valid upto :<%= ssl.validTo%></h6>

              <%}else{%>
              <h6 class="subheading">SSL Certificate: Not Present </h6>
              <%}%>
              <br>
              <% if(missing_headers != "" ){%>
              <h6 class="heading">Missing Headers:</h6>
              <% var m = missing_headers%>
              <table>
                <%m.forEach(myFunction);%>

                <%function myFunction(item, index) {%>

                <% if(index < 10){%>
                <%var s = (item.msg).split(":");%>

                <tr>
                  <td class="subheading"> <%=s[0]%> : </td>
                  <td class="subheading"><%=s[1]%></td>
                </tr>
                <% }%>
                <%}%>

                </table>
            <%}%>


            <% if(head != "" ){%>
              <h6 class="heading"> Headers Present:</h6>
              <h6 class="subheading">Connection Type : <%= head.connection%></h6>
              <h6 class="subheading">Server : <%= head.server%></h6>
             
            <%}%>




        </div>
        <div class="modal-footer">
          <form method="POST" action="/download" id="form3">
            <input type="submit" value="download Report" class="btn btn-primary">
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-lg-8 box">
      <h3>Website Vulnerability Scanner</h3>
      <h5>Discover common web application vulnerabilities</h5>

      <div id="box1">
        <div class="row">
          <div class="nav1 active col-lg-6 col-sm-3 " id="a"><i class="fas fa-search fa-lg"></i>QUICK SCAN</div>
          <div class="nav1 col-lg-6 col-sm-3 " id="b"><i class="fab fa-searchengin fa-lg"></i>FULL SCAN</div>
        </div>

        <div class="a2">


          <form method="POST" action="/quickScan" id="form1">
            <div class="row a1 ">

              <div class="col-lg-4">

                <input type="text" placeholder="www.samplewebsite.com" name="website" autocomplete="off" required
                  id="qs">
                <p class="text">
                  </h6>
              </div>

              <div class="col-lg-3">
                <input type="submit" class="btn btn-info" value="Scan">

              </div>
              <h5 style="color: #243d81; margin-top: 4%;">Quick scan is a light weight scan which can discover most common vulnerabilities</h5>

            </div>
          </form>

        </div>



        <!--  -->
        <div class="b2">

          <form method="POST" action="/fullScan" id="form2">
            <div class="row b1 ">

              <div class="col-lg-4">

                <input type="text" placeholder="www.samplewebsite.com" name="website" autocomplete="off" required
                  id="fs">
                <p class="text" style="margin-left: 0%;">
                  </h6>
              </div>

              <div class="col-lg-3">
                <input type="submit" class="btn btn-info" value="Scan">
              </div>
              <h5 style="color: #243d81; margin-top: 4%;">Full scan is a detailed scan which can discover a wide range of vulnerabilities</h5>
              


            </div>
          </form>

        </div>

        <div class="row">
          <div class="col-lg-12 tb">
            <h3 style="color:#243d81 ;">LIST OF TESTS PERFORMED</h3>
            <table>
              <tr>
                <th>TEST PERFORMED</th>
                <th>QUICK SCAN</th>
                <th>FULL SCAN</th>
                
              </tr>

              <tr>
                <td>IP Address</td>
                <td><i class="fas fa-check fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
                
              </tr>

              <tr>
                <td>SSL Certificate</td>
                <td><i class="fas fa-check fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
                
              </tr>

              <tr>
                <td>SSL-no of days left to expire</td>
                <td><i class="fas fa-check fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
              </tr>
              <tr>
                <td>SSL- Valid from</td>
                <td><i class="fas fa-times fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
              </tr>
              <tr>
                <td>SSL- Valid to</td>
                <td><i class="fas fa-times fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
              </tr>

              <tr>
                <td>Missing Headers</td>
                <td><i class="fas fa-check fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
                
              </tr>
              <tr>
                <td>Server name</td>
                <td><i class="fas fa-times fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td> 
              </tr>
              <tr>
                <td>Connection type</td>
                <td><i class="fas fa-times fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td> 
              </tr>

              <tr>
                <td>Technologies detected</td>
                <td><i class="fas fa-times fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
              </tr>
              <tr>
                <td>Technology Version</td>
                <td><i class="fas fa-times fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
              </tr>

              <tr>
                <td>Open Ports</td>
                <td><i class="fas fa-times fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
              </tr>

              <tr>
                <td>OS</td>
                <td><i class="fas fa-times fa-2x"></i></td>
                <td><i class="fas fa-check fa-2x"></i></td>
              </tr>

            </table>
          </div>
        </div>

      </div>

    </div>
  </div>
</div>
<%- include("partials/footer")-%>

<script>
  let info = '<%= info %>'
  if (info == "1") {
    $('#MyModal').modal('show');
  }
  if (info == "3") {
    $('#MyModal2').modal('show');
  }
</script>